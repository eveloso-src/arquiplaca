<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<title>Producto</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/registration.css}" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" th:href="@{/css/home.css}" />
</head>
<body>
	<script type="text/javascript" th:src="@{/js/utils.js}"></script>
	<header th:replace="layouts/base::header(dark)"> </header>

	<div class="container">
		<div class="row">
			<!-- 			<div class="col-md-6 col-md-offset-3"> -->
			<div class="col-md-4">

				<div class="panel-group" style="margin-top: 40px">

					<div class="panel panel-primary">
						<div class="panel-heading">
							<b><span th:utext="'Nuevo Producto'"></span></b>
						</div>
						<div class="panel-body">



							<form autocomplete="off" th:action="@{/product}"
								th:object="${product}" method="post" id="form"
								class="form-horizontal">
								<div class="form-group">
									<div class="col-sm-4">
										<label th:if="${#fields.hasErrors('code')}"
											th:errors="*{code}" class="validation-message"></label><b>Codigo:</b>
										<input type="text" th:field="*{code}" placeholder=""
											class="form-control" />
<!-- 											onBlur="getColor()" -->
									</div>
									<div class="form-group col-md-4 capitalize">
										<b>Color: </b><select th:field="*{color}"  id="color" name="color" class="form-control">
											<option value="PZ">PZ</option>
											<option value="W/N">W/N</option>
											<option value="H/B">H/B</option>
											<option value="N/B">N/B</option>
											<option value="B">B</option>
											<option value="P">P</option>
											<option value="Z">Z</option>
											<option value="N">N</option>
											<option value="B/N">B/N</option>
											<option value="B/H">B/H</option>
										</select>
									</div>
								</div>

								<div class="form-group">
									<div class="col-sm-9">
										<b>Descripción:</b> <input type="text" id="description"
											th:field="*{description}" placeholder="" class="form-control" />
										<label th:if="${#fields.hasErrors('description')}"
											th:errors="*{description}" class="validation-message"></label>
									</div>
								</div>
								<div class="form-group">
									<div class="col-sm-4">
										<b>Stock:</b> <input type="number" th:field="*{stock}"
											id="stock" placeholder="" class="form-control" /> <label
											th:if="${#fields.hasErrors('stock')}" th:errors="*{stock}"
											class="validation-message"></label>
									</div>
									<div class="col-sm-4">
										<b>m2:</b> <input type="number" th:field="*{m2}"
											id="m2" placeholder="" class="form-control" /> <label
											th:if="${#fields.hasErrors('m2')}" th:errors="*{m2}"
											class="validation-message"></label>
									</div>
								</div>

								<div class="form-group">
									<div class="col-sm-4">
										<button id="newProd" class="btn btn-primary btn-block"
											type="button">
											<b>Crear</b>
										</button>
									</div>
								</div>

								<span th:utext="${successMessage}"></span>


							</form>
						</div>
					</div>
				</div>
			</div>

			<div class="col-md-8">

				<div class="panel-group" style="margin-top: 40px">


					<div class="panel panel-primary">
						<div class="panel-heading">
							<b><span th:utext="'Listado de Productos'"> </span></b>
						</div>

						<div class="panel-body">
							<table id="tableProds"
								class="table table-striped table-hover table-condensed">

								<thead>
									<tr>
										<th></th>
										<th></th>
										<th>Codigo</th>
										<th>Color</th>
										<th>Descripción</th>
										<th>Stock</th>
										<th>m2</th>
									</tr>
								</thead>
								<tr th:each="item: ${listprod}">
									<td><a href="product"><i class="fa fa-pencil-square-o"></i></a></td>
									<td><a href="delete"><i class="fa fa-trash"></i></a></td>
									<td th:text="${item.code}"></td>
									<td th:text="${item.color}" />
									<td th:text="${item.description}" />
									<td th:text="${item.stock}" />
									<td th:text="${item.m2}" />
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>

		</div>

	</div>
</body>

<script>
	$('#newProd').click(
			function() {
				// 	console.log($("#form").serialize());
				$.ajax({
					type : 'POST',
					url : $("#form").attr("action"),
					data : $("#form").serialize(),
					success : function(response) {
						var table = document.getElementById('tableProds')
								.getElementsByTagName('tbody')[0];
						var row = table.insertRow(0);
						var cell1 = row.insertCell();
						var cell2 = row.insertCell();
						
						cell1.innerHTML = '<a href="product"><i class="fa fa-pencil-square-o"></i></a>';
						cell2.innerHTML = '<a href="delete"><i class="fa fa-trash"></i></a>';
						addRow(row, 'code');
						addRow(row, 'color');
						addRow(row, 'description');
						addRow(row, 'stock');
						addRow(row, 'm2');

					},
					error : function(response) {
						console.log("error")
					}
				});
			});
	function getColor() {
		let colorText = document.getElementById("code").value;
		document.getElementById("code").value = document.getElementById("code").value
				.toUpperCase();
		colorText = colorText.replace(/[0-9]/g, '');
		document.getElementById("colorInput").value = colorText.toUpperCase();

	}
</script>

</html>